---
title: "phsmethods R Package"
subtitle: "PHI useR Group"
author: 'Jack Hannah <br> Transforming Publishing Programme <br>'
date: "25 March 2020 <br><br> Slides: https://github.com/jackhannah95/phsmethods-slides"
output:
  ioslides_presentation:
    css: my-theme.css
---

```{r setup, include = FALSE}
# Load packages required
library(knitr)
library(dplyr)
library(phsmethods)
library(gt)

knitr::opts_chunk$set(echo = TRUE)

pub_text <- c("Table 1 (Hospital Standardised Mortality Ratios)",
              paste("Table 2 (NHSScotland, NHS Board and hospital overall", 
                    "crude mortality trends and NHSScotland crude mortality", 
                    "trends by demographics and quarter)"),
              paste("Table 3 (Crude 30-day mortality from discharge and", 
                    "Overall population crude mortality rates by NHS Board", 
                    "and quarter)"))
```

## Why write a package?

## phsmethods::file_size()
```{r}
# All files in the data folder
file_size(here::here("data"))
```

## phsmethods::file_size()
```{r}
# Excel files only
file_size(here::here("data"), pattern = ".xlsx$")
```

## file_size() in practice
This is the 'List of Tables' section from page 25 of the [2019-11-12 HSMR publication](https://www.isdscotland.org/Health-Topics/Quality-Indicators/Publications/2019-11-12/2019-11-12-HSMR-Report.pdf):

```{r, echo = FALSE, size = "150%"}
include_graphics(here::here("images", "2019-11-12_HSMR-Tables.jpg"))
```

## Recreate using file_size and [{gt}](https://github.com/rstudio/gt)
```{r, gt, results = "hide"}
file_size(here::here("data"), pattern = ".xlsx?$") %>%
  mutate(name = pub_text) %>%
  gt() %>%
  tab_style(style = cell_borders(),
            locations = cells_body(columns = everything(),
                                   rows = everything())) %>%
  tab_style(style = cell_text(color = "white", weight = "bolder"),
            locations = cells_column_labels(columns = everything())) %>%
  tab_style(style = cell_text(color = "purple", 
                              decorate = "underline"),
            locations = cells_body(columns = vars(name))) %>%
  tab_style(style = cell_text(weight = "bold"),
            locations = cells_body(columns = vars(name, size))) %>%
  tab_style(style = cell_fill(color = "darkorchid4"),
            locations = cells_column_labels(columns = everything())) %>%
  cols_width(vars(name) ~ px(620), TRUE ~ px(75)) %>%
  cols_label(name = "File Name", size = "File and Size")
```

## Recreate using file_size and [{gt}](https://github.com/rstudio/gt)

```{r, ref.label = "gt", echo = FALSE}
```